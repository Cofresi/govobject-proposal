<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>govobject-proposal</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.0/themes/smoothness/jquery-ui.css">

    <script src="https://code.jquery.com/jquery-3.1.0.js" integrity="sha256-slogkvB1K3VOkzAI8QITxV3VzpOnkeNVsKvtkYLMjfk=" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.0/jquery-ui.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script src="bitcore-lib-dash.js"></script>

    <script type="text/javascript">

        var Bitcore = require('bitcore-lib-dash');

        $(document).ready(function() {

            var opts = { dateFormat: $.datepicker.ISO_8601 };

            $('#start_epoch').datepicker(opts, 'getdate');
            $('#end_epoch').datepicker(opts, 'getdate');

            $('#dataHex').click(function() {
               copyToClipboard($(this).attr('id'));
            });

            $('#prepareProposal').click(function() {
                copyToClipboard($(this).attr('id'));
            });

            $('#submitProposal').click(function() {
                copyToClipboard($(this).attr('id'));
            });

            $('#formSubmit').click(function() {

                var gov = new Bitcore.GovObject.Proposal();

                // proposal basic fields
                gov.name = document.getElementById('name').value;
                gov.url = document.getElementById('url').value;
                gov.payment_address = document.getElementById('payment_address').value;
                gov.payment_amount = parseFloat(document.getElementById('payment_amount').value);

                // format dates for gobject serialization
                gov.start_epoch = (new Date(document.getElementById('start_epoch').value) / 1000) || null;
                gov.end_epoch = (new Date(document.getElementById('end_epoch').value) / 1000) || null;

                // hidden elements
                gov.type = parseInt(document.getElementById('type').value);

                document.getElementById('dataHex').innerHTML = gov.uncheckedSerialize();

                document.getElementById('prepareProposal').innerHTML = "dash-cli gobject submit "+document.getElementById('parentHash').value+" "+document.getElementById('revision').value+" "+document.getElementById('time').value+" "+gov.uncheckedSerialize();

                if (document.getElementById('feeTxid').value) {
                    document.getElementById('submitProposal').innerHTML = "dash-cli gobject submit " + document.getElementById('parentHash').value + " " + document.getElementById('revision').value + " " + document.getElementById('time').value + " " + gov.uncheckedSerialize() + " " + document.getElementById('feeTxid').value;
                }

            });
        });

        function copyToClipboard(id)
        {
            document.getElementById(id).select();
            document.execCommand('copy');
        }

    </script>

    <style type="text/css">
        textarea { background-color:#fafafa !important; }
    </style>

</head>
<body>

<div class="col-xs-10 col-xs-offset-1">

    <div class="row" style="margin-top:2em;">
        <div class="col-xs-12"><h1>Dash Governance Proposal Creation</h1></div>
    </div>

    <div class="row" style="margin-top:1em;">
        <div class="col-xs-6">

            <form>

                <div class="form-group">
                    <label for="name">Proposal Name:</label>
                    <input type="text" class="form-control" id="name" value="" placeholder="proposal-name">
                </div>

                <div class="form-group">
                    <label for="url">Proposal URL:</label>
                    <input type="text" class="form-control" id="url" value="" placeholder="https://www.dashcentral.org/p/proposal-name">
                </div>

                <div class="form-group">
                    <label for="payment_address">Payment Address:</label>
                    <input type="text" class="form-control" id="payment_address" value="" placeholder="">
                </div>

                <div class="form-group">
                    <label for="payment_amount">Payment Amount in Dash</label>
                    <input type="text" class="form-control" id="payment_amount" value="" placeholder="0">
                </div>

                <div class="form-group">
                    <label for="start_epoch">Proposal Start Date:</label>
                    <input type="text" class="form-control" id="start_epoch" value="" placeholder="">
                </div>

                <div class="form-group">
                    <label for="end_epoch">Proposal End Date:</label>
                    <input type="text" class="form-control" id="end_epoch" value="" placeholder="">
                </div>

                <div type="submit" class="btn btn-primary" id="formSubmit">Create Proposal</div>

                <hr>

                <div class="form-group" style="display:none;">
                    <label for="type">type:</label>
                    <input type="text" class="form-control" id="type" value="1" placeholder="1">
                </div>

                <div class="form-group" style="display:none;">
                    <label for="parentHash">parent-hash:</label>
                    <input type="text" class="form-control" id="parentHash" value="0" placeholder="0">
                </div>

                <div class="form-group" style="display:none;">
                    <label for="revision">revision:</label>
                    <input type="text" class="form-control" id="revision" value="1" placeholder="1">
                </div>

                <div class="form-group" style="display:none;">
                    <label for="time">Creation Time:</label>
                    <input type="text" class="form-control" id="time" value="" placeholder="">
                </div>

                <div class="form-group" style="display:none;">
                    <label for="feeTxid">fee-txid:</label>
                    <input type="text" class="form-control" id="feeTxid" value="" placeholder="<fee-txid>">
                </div>

            </form>

        </div>

    </div>

    <div class="row" style="margin-top:2em;">

        <div class="col-xs-6">

            <form>

                <div class="form-group">
                    <label for="dataHex">data-hex:</label>
                    <textarea class="form-control" id="dataHex" rows="6" placeholder=""></textarea>
                </div>

            </form>

        </div>

        <div class="col-xs-6">

            <form>

                <div class="form-group">
                    <label for="prepareProposal">prepare proposal:</label>
                    <textarea class="form-control" id="prepareProposal" rows="4" placeholder=""></textarea>
                </div>

                <div class="form-group">
                    <label for="submitProposal">submit proposal:</label>
                    <textarea class="form-control" id="submitProposal" rows="4" placeholder=""></textarea>
                </div>

            </form>

        </div>

    </div>

</div>

</body>
</html>
